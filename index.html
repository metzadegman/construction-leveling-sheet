<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Construction Leveling Sheet</title>
    <style>
      body { font-family: system-ui, Arial, sans-serif; padding: 40px; background:#f7f7f8; }
      .card { max-width: 700px; margin: 0 auto 16px auto; padding: 28px; border: 1px solid #ddd; border-radius: 16px; background:#fff; }
      h1 { margin-top: 0; }
      .ok { background:#e8f5e9; padding:8px 12px; border-radius:8px; display:inline-block; }
      .muted { color:#6b7280; font-size:14px; }
      .btn { background:#111827; color:#fff; border:none; padding:8px 14px; border-radius:8px; cursor:pointer; font-size:14px; }
    </style>
  </head>
  <body>
    <!-- Upload PDF Takeoff -->
    <div class="card">
      <h2>Upload Takeoff (PDF)</h2>
      <input type="file" id="pdfFile" accept="application/pdf" />
      <button class="btn" id="uploadPdf">Upload PDF</button>
      <div id="uploadStatus" class="muted" style="margin-top:8px"></div>
    </div>

    <!-- Starter content -->
    <div class="card">
      <h1>ðŸš§ Construction Leveling Sheet â€” Starter Page</h1>
      <p>If you can see this page on your <strong>.vercel.app</strong> link, the site is live.</p>
      <p class="ok">Next: weâ€™ll switch this to the real app and connect Supabase.</p>
    </div>

    <script type="module">
      import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

      // ðŸ”‘ Replace this with your real anon key from Supabase â†’ Project Settings â†’ API
      const SUPABASE_URL = "https://rplmmwtlusqrbuzdanxx.supabase.co";
      const SUPABASE_ANON_KEY = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJwbG1td3RsdXNxcmJ1emRhbnh4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwNzA1MjMsImV4cCI6MjA3ODY0NjUyM30.GI9tq-ItRpJyDEyj2OUQeefGSkIk0_1-ofIm1b3fGrc

      const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      const el = (id) => document.getElementById(id);

      async function uploadTakeoff() {
        try {
          const file = el("pdfFile").files[0];
          if (!file) {
            el("uploadStatus").innerHTML = "<span style='color:red'>Choose a PDF first.</span>";
            return;
          }

          el("uploadStatus").innerText = "Uploadingâ€¦";

          const fileName = `${Date.now()}_${file.name.replace(/\s+/g, "_")}`;

          const { error } = await supabase.storage
            .from("takeoffs")
            .upload(fileName, file, {
              contentType: "application/pdf",
            });

          if (error) throw error;

          el("uploadStatus").innerHTML = `<span style='color:green'>Uploaded: ${fileName}</span>`;
        } catch (err) {
          console.error(err);
          el("uploadStatus").innerHTML = "<span style='color:red'>Error uploading file.</span>";
        }
      }

      document.addEventListener("click", (e) => {
        if (e.target.id === "uploadPdf") uploadTakeoff();
      });
    </script>
  </body>
</html>

